---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Theme from "../../layouts/Theme.astro";
import Footer from "../../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";
import { getCollection } from "astro:content";
import EventListContainer from "../../components/EventListContainer";

const orgs = await getCollection("orgs");
const now = new Date();
const events = (await getCollection("events"))
  .filter((event) => new Date(event.data.startDate) >= now)
  .sort((a, b) => a.data.startDate.valueOf() - b.data.startDate.valueOf());
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Theme>
      <Header />
      <main class="events-list-page pt-xl pb-3xl">
        <h1 class="text-3xl text-bold text-accent mb-xl">Upcoming Events</h1>
        <EventListContainer orgs={orgs} initialEvents={events} client:load />
      </main>
      <Footer />
    </Theme>
  </body>
</html>
