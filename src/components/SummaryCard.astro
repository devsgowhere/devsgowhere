---
import FormattedEventDate from "../components/FormattedEventDate.astro";
import AddToCalendarButton from "../components/AddToCalendarButton.tsx";
import "../styles/GlobalStyles.astro";

// Props for the SummaryCard component
export interface Props {
  title: string;
  description: string;
  startDate: string;
  endDate: string;
  startTime: string;
  endTime: string;
  venue: string;
  org: string;
  venueAddress: string;
  rsvpButtonUrl: string;
  rsvpButtonText: string;
}

const {
  title,
  description,
  startDate,
  endDate,
  startTime,
  endTime,
  venue,
  org,
  venueAddress,
  rsvpButtonUrl,
  rsvpButtonText,
} = Astro.props;
---

<div class="card" style="overflow:visible;">
  <h2 class="summary-card__title text-accent m-l">{title}</h2>
  <div class="summary-card__details m-m">
    <div class="event-date ml-m">
      <i class="fa-solid fa-clock mr-xs"></i>      
      <FormattedEventDate        
        startDate={startDate ? new Date(startDate) : undefined}
        startTime={startTime}
        endDate={endDate ? new Date(endDate) : undefined}
        endTime={endTime}
      />
    </div>
    <div class="event-location m-m">
      <div style="display: flex; align-items: baseline;">
        <i class="fa-solid fa-location-dot mr-xs"></i>        
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
        <p class="ml-xs mt-0" style="font-weight: bold;">{venue}</p>
        <p class="text-capitalise ml-xs mt-0">{(venueAddress ?? '').toLowerCase()}</p>
        </div>
      </div>
    </div>
    <div
      style="display: flex; flex-direction: column; align-items: center;"      
      class="mb-l"
    >
      {
        rsvpButtonUrl && (
          <a
            href={rsvpButtonUrl}
            class="rsvp-button"
            target="_blank"
            rel="noopener noreferrer"
          >
            {rsvpButtonText ?? "RSVP"}
          </a>
        )
      }      
      <AddToCalendarButton        
        client:only="react"
        label="Add to Calendar" 
        name={title}
        options="'Apple','Google'"
        location={venue}
        startDate={new Date(startDate).toISOString().split("T")[0]}
        endDate={new Date(endDate).toISOString().split("T")[0]}
        startTime="00:00"
        endTime="00:00"
        timeZone="Singapore"
      />
    </div>
  </div>

  <style>
    .summary-card__title {
      font-size: 1.5rem;      
    }

    .summary-card__details {
      color: #555;
      text-align: left;
    }

    .summary-card__details p {
      margin: 4px 0;
    }

    .rsvp-button {
      display: inline-block;
      padding: 0.4em 0.8em;
      margin: 0.5em 0;
      background-color: var(--accent, #007BFF);
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: bold;
      transition: background-color 0.2s ease;
    }
    .rsvp-button:hover {
      background-color: var(--accent,  #0056b3);
      color: white;
    }
  </style>
</div>
